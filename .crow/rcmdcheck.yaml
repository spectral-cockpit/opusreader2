when:
  - event: [pull_request, manual]
  - event: push
    branch: $CI_REPO_DEFAULT_BRANCH

steps:
  'Check package (nix)':
    image: spectralcockpit/nix-datascience-alpine:4.5.1-alpine-3.22
    pull: true
    environment:
      _R_CHECK_FORCE_SUGGESTS_: FALSE
      _R_CHECK_SYSTEM_CLOCK_: FALSE
    commands:
      - >
        nix-shell --run 'Rscript -e "rcmdcheck::rcmdcheck( 
          args = c(\"--as-cran\"), 
          error_on = \"warning\")"'
